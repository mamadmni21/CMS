<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Purchase Schedule</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="{{ url_for('static', filename='assets/css/purchase_schedule.css') }}" rel="stylesheet">

    <!-- Select2 and jQuery -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-left">
            <img src="{{ url_for('static', filename='assets/img/logo_cms.png') }}" alt="CMS Icon">
            <h1>Purchase schedule</h1>
        </div>
        <div class="top-right">
        <a href="javascript:history.back()" class="back-button">
            <span class="material-icons">arrow_back</span>
        </a>
        </div>
    </div>
    <div class="purchase-container">

    <!-- Box 1: Item List -->
    <aside class="item-list">
        <h2>Purchasing Items</h2>

        <!-- ðŸ” Search box added -->
        <input type="text" id="searchInput" placeholder="Search by Item Code...">

        <ul id="items">
            <li onclick="selectItem('ITM001', 'Laptop')" data-code="ITM001">ITM001 - Laptop<br><small>Order: ORD0001 | Purchase: PUR0001</small></li>
            <li onclick="selectItem('ITM002', 'Printer')" data-code="ITM002">ITM002 - Printer<br><small>Order: ORD0002 | Purchase: PUR0002</small></li>
            <li onclick="selectItem('ITM003', 'Projector')" data-code="ITM003">ITM003 - Projector<br><small>Order: ORD0003 | Purchase: PUR0003</small></li>
            <li onclick="selectItem('ITM004', 'Office Chair')" data-code="ITM004">ITM004 - Office Chair<br><small>Order: ORD0004 | Purchase: PUR0004</small></li>
        </ul>
    </aside>

    <!-- Box 2: Schedule Table -->
    <main class="schedule-section">
        <header>
        <h2>Purchase Schedule</h2>
        <div class="date-range">
            <label for="startDate">From: </label>
            <input type="date" id="startDate">
            <label for="endDate">To: </label>
            <input type="date" id="endDate">
            <button onclick="filterSchedule()">Filter</button>
        </div>
        </header>

        <table id="scheduleTable">
        <thead>
            <tr>
            <th>Date</th>
            <th>Order ID</th>
            <th>Purchase ID</th>
            <th>Item Code</th>
            <th>Item Name</th>
            <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <!-- Dummy schedule data with Order ID & Purchase ID -->
            <tr data-item="ITM001">
              <td>2025-09-18</td><td>ORD0001</td><td>PUR0001</td><td>ITM001</td><td>Laptop</td><td>Ordered</td>
            </tr>
            <tr data-item="ITM002">
              <td>2025-09-20</td><td>ORD0002</td><td>PUR0002</td><td>ITM002</td><td>Printer</td><td>Pending</td>
            </tr>
            <tr data-item="ITM001">
              <td>2025-09-22</td><td>ORD0001</td><td>PUR0001</td><td>ITM001</td><td>Laptop</td><td>Delivered</td>
            </tr>
            <tr data-item="ITM003">
              <td>2025-09-25</td><td>ORD0003</td><td>PUR0003</td><td>ITM003</td><td>Projector</td><td>Scheduled</td>
            </tr>
        </tbody>
        </table>
    </main>
    </div>

    <script>
    // Auto-fill current month in date inputs
    window.onload = function () {
        const today = new Date();
        const year = today.getFullYear();
        const month = today.getMonth();

        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);

        document.getElementById("startDate").value = firstDay.toISOString().split('T')[0];
        document.getElementById("endDate").value = lastDay.toISOString().split('T')[0];
    };

    // Item selection filter
    function selectItem(code, name) {
        const rows = document.querySelectorAll("#scheduleTable tbody tr");
        rows.forEach(row => {
        row.style.display = row.dataset.item === code ? "" : "none";
        });
    }

    // Date range filter
    function filterSchedule() {
        const start = new Date(document.getElementById("startDate").value);
        const end = new Date(document.getElementById("endDate").value);
        const rows = document.querySelectorAll("#scheduleTable tbody tr");

        rows.forEach(row => {
        const rowDate = new Date(row.cells[0].innerText);
        if ((!isNaN(start) && rowDate < start) || (!isNaN(end) && rowDate > end)) {
            row.style.display = "none";
        } else {
            row.style.display = "";
        }
        });
    }

    // ðŸ” Search function for item-list
    const searchInput = document.getElementById("searchInput");
    const itemList = document.querySelectorAll("#items li");

    searchInput.addEventListener("keyup", function () {
        const filter = searchInput.value.toUpperCase();
        itemList.forEach(item => {
            const code = item.getAttribute("data-code");
            if (code.toUpperCase().indexOf(filter) > -1) {
                item.style.display = "";
            } else {
                item.style.display = "none";
            }
        });
    });
    </script>

</body>
</html>
